<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vote on Sign Designs — Help Us Pick the Best Counter-Signs | Not Our Water</title>
<meta name="description" content="Vote for your favorite counter-sign designs or submit your own. Help us pick the signs that will answer Turning Point in SRP District 6.">
<link rel="canonical" href="https://www.notourwater.org/signs/poll/">
<meta name="robots" content="index, follow">
<meta name="theme-color" content="#1a1612">

<!-- Open Graph -->
<meta property="og:title" content="Vote on Sign Designs — Not Our Water">
<meta property="og:description" content="Vote for your favorite counter-sign designs or submit your own idea.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://www.notourwater.org/signs/poll/">
<meta property="og:site_name" content="Not Our Water">
<meta property="og:image" content="https://www.notourwater.org/og-image.png">

<!-- Favicon -->
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Archivo+Black&family=Bebas+Neue&family=Oswald:wght@500;600;700&family=Space+Mono:wght@400;700&family=Source+Serif+4:ital,opsz,wght@0,8..60,400;0,8..60,600;0,8..60,700;1,8..60,400&display=swap" rel="stylesheet">
<style>
  :root {
    --earth: #e2d5be;
    --earth-light: #f0e8d8;
    --earth-pale: #f7f2ea;
    --earth-dark: #c8b896;
    --earth-deep: #a89470;
    --cracked: #8a7656;
    --bedrock: #1a1612;
    --bedrock-mid: #2a2420;
    --bedrock-light: #3d352e;
    --water: #1a6b9a;
    --water-bright: #2a8fc7;
    --water-deep: #0e3f5e;
    --water-surface: #8cc5e3;
    --rust: #c4522a;
    --rust-light: #e07040;
    --ink: #12100e;
    --ink-mid: #5a5248;
    --fight: #b82e1a;
    --fight-light: #d44a2e;
    --fight-glow: rgba(184, 46, 26, 0.15);
    --success: #3a8a4a;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }
  html { scroll-behavior: smooth; }

  body {
    font-family: 'Source Serif 4', Georgia, serif;
    background: var(--bedrock);
    color: var(--earth-light);
    -webkit-font-smoothing: antialiased;
    overflow-x: hidden;
  }

  body::after {
    content: '';
    position: fixed;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.035'/%3E%3C/svg%3E");
    pointer-events: none;
    z-index: 9999;
  }

  .back {
    position: fixed;
    top: 20px;
    left: 20px;
    z-index: 100;
    font-family: 'Space Mono', monospace;
    font-size: 10px;
    font-weight: 700;
    letter-spacing: 2px;
    text-transform: uppercase;
    text-decoration: none;
    color: var(--earth-deep);
    padding: 10px 16px;
    background: var(--bedrock);
    border: 1px solid var(--bedrock-light);
    transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
  }
  .back:hover { border-color: var(--earth-dark); color: var(--earth-light); transform: translateY(-1px); }

  .rv { opacity: 0; transform: translateY(32px); transition: opacity 0.7s cubic-bezier(0.16, 1, 0.3, 1), transform 0.7s cubic-bezier(0.16, 1, 0.3, 1); }
  .rv.vis { opacity: 1; transform: translateY(0); }
  .rv-d1 { transition-delay: 0.08s; }
  .rv-d2 { transition-delay: 0.16s; }
  .rv-d3 { transition-delay: 0.24s; }
  .rv-d4 { transition-delay: 0.32s; }

  .marker {
    font-family: 'Space Mono', monospace;
    font-size: 10px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 3px;
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 32px;
  }
  .marker-line { width: 32px; height: 1px; }
  .marker--red { color: var(--fight-light); }
  .marker--red .marker-line { background: var(--fight-light); }
  .marker--blue { color: var(--water-bright); }
  .marker--blue .marker-line { background: var(--water-bright); }

  .section-title {
    font-family: 'Archivo Black', sans-serif;
    font-weight: 400;
    font-size: clamp(32px, 5vw, 52px);
    line-height: 0.95;
    color: var(--earth-light);
  }
  .section-sub {
    font-size: clamp(15px, 1.3vw, 18px);
    color: var(--earth-deep);
    line-height: 1.6;
    margin-top: 16px;
    max-width: 540px;
  }

  /* ── Buttons ── */
  .btn {
    display: inline-flex;
    align-items: center;
    font-family: 'Space Mono', monospace;
    font-size: 12px;
    font-weight: 700;
    text-decoration: none;
    cursor: pointer;
    border: none;
    letter-spacing: 1px;
    text-transform: uppercase;
    transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1), box-shadow 0.3s cubic-bezier(0.16, 1, 0.3, 1);
  }
  .btn:hover { transform: translateY(-2px); }
  .btn:active { transform: translateY(1px); transition-duration: 0.06s; }

  .btn--fight {
    background: var(--fight);
    color: #fff;
    padding: 20px 40px;
    font-size: 13px;
    position: relative;
    overflow: hidden;
  }
  .btn--fight::after {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at center, rgba(255,255,255,0.2) 0%, transparent 70%);
    opacity: 0;
    transition: opacity 0.4s ease;
  }
  .btn--fight:hover::after { opacity: 1; }
  .btn--fight:hover { box-shadow: 0 8px 32px rgba(184, 46, 26, 0.45); }

  .btn--ghost {
    background: transparent;
    color: var(--earth-dark);
    border: 1px solid var(--bedrock-light);
    padding: 19px 39px;
  }
  .btn--ghost:hover { border-color: var(--earth-dark); color: var(--earth-light); }

  /* ── Hero ── */
  .hero {
    min-height: 55vh;
    background: var(--bedrock);
    position: relative;
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding: clamp(100px, 14vh, 180px) clamp(32px, 6vw, 100px) clamp(60px, 8vh, 100px);
    overflow: hidden;
  }
  .hero::before {
    content: '';
    position: absolute;
    inset: 0;
    opacity: 0.02;
    background: repeating-linear-gradient(-45deg, transparent, transparent 40px, var(--water) 40px, var(--water) 42px);
    pointer-events: none;
  }
  .hero-glow {
    position: absolute;
    top: 20%;
    right: -10%;
    width: 500px;
    height: 500px;
    background: radial-gradient(circle, rgba(42, 143, 199, 0.1) 0%, transparent 70%);
    pointer-events: none;
  }
  .hero-content { position: relative; z-index: 2; max-width: 800px; }
  .hero h1 {
    font-family: 'Archivo Black', sans-serif;
    font-weight: 400;
    font-size: clamp(44px, 8vw, 96px);
    line-height: 0.92;
    color: var(--earth-light);
    letter-spacing: -2px;
    margin-bottom: 32px;
    opacity: 0;
    animation: enter-up 0.8s 0.2s cubic-bezier(0.16, 1, 0.3, 1) forwards;
  }
  .hero h1 .accent { color: var(--water-bright); }
  .hero-sub {
    font-size: clamp(17px, 1.8vw, 22px);
    line-height: 1.65;
    color: var(--earth-deep);
    max-width: 560px;
    margin-bottom: 40px;
    opacity: 0;
    animation: enter-up 0.7s 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards;
  }
  .hero-sub strong { color: var(--earth-light); font-weight: 700; }
  .hero-cta {
    display: flex;
    gap: 16px;
    flex-wrap: wrap;
    opacity: 0;
    animation: enter-up 0.7s 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards;
  }
  @keyframes enter-up {
    from { opacity: 0; transform: translateY(24px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* ══════════════════════════════════
     VOTE SECTION
  ══════════════════════════════════ */
  .vote-section {
    background: var(--bedrock);
    padding: clamp(60px, 8vh, 120px) clamp(32px, 6vw, 100px);
  }
  .vote-inner { max-width: 960px; margin: 0 auto; }

  .total-votes {
    font-family: 'Space Mono', monospace;
    font-size: 12px;
    color: var(--earth-deep);
    letter-spacing: 0.5px;
    margin-top: 24px;
  }
  .total-votes strong {
    color: var(--earth-light);
    font-size: 18px;
  }

  .vote-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 24px;
    margin-top: 40px;
  }

  .vote-card {
    background: var(--bedrock-mid);
    border: 1px solid var(--bedrock-light);
    overflow: hidden;
    transition: transform 0.35s cubic-bezier(0.16, 1, 0.3, 1), box-shadow 0.35s cubic-bezier(0.16, 1, 0.3, 1), border-color 0.35s ease;
  }
  .vote-card:hover { transform: translateY(-4px); box-shadow: 0 16px 48px rgba(0,0,0,0.3); border-color: var(--earth-dark); }

  .vote-preview {
    width: 100%;
    aspect-ratio: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    position: relative;
  }

  /* ── Mini Sign B: "Your Water. Their Data Centers." ── */
  .mini-sign-b {
    width: 100%; height: 100%;
    background: linear-gradient(170deg, #1a0a00 0%, #2d1200 40%, #1a0a00 100%);
    display: flex; flex-direction: column;
    justify-content: center; align-items: center;
    padding: 8%; text-align: center;
    position: relative;
  }
  .mini-sign-b::before {
    content: ''; position: absolute; top: 0; left: 0; right: 0;
    height: 6px; background: #ff6b35;
  }
  .mini-sign-b::after {
    content: ''; position: absolute; bottom: 0; left: 0; right: 0;
    height: 6px; background: #ff6b35;
  }
  .mini-sign-b .s-line1 {
    font-family: 'Bebas Neue', sans-serif;
    font-size: clamp(24px, 5vw, 44px); color: #fff;
    line-height: 1; letter-spacing: 2px;
  }
  .mini-sign-b .s-line2 {
    font-family: 'Bebas Neue', sans-serif;
    font-size: clamp(18px, 3.5vw, 32px); color: #ff6b35;
    line-height: 1; letter-spacing: 1px; margin-bottom: 6%;
  }
  .mini-sign-b .s-divider {
    width: 25%; height: 2px;
    background: rgba(255,107,53,0.4); margin: 0 auto 6%;
  }
  .mini-sign-b .s-stat {
    font-family: 'Oswald', sans-serif; font-weight: 600;
    font-size: clamp(9px, 1.3vw, 12px); color: #cc8855;
    text-transform: uppercase; letter-spacing: 1.5px;
    line-height: 1.4; margin-bottom: 8%;
  }
  .mini-sign-b .s-url {
    font-family: 'Bebas Neue', sans-serif;
    font-size: clamp(14px, 2.5vw, 22px); color: #fff;
    letter-spacing: 2px;
    background: rgba(255,107,53,0.15); padding: 4px 12px;
    border: 1.5px solid rgba(255,107,53,0.4);
  }

  /* ── Mini Sign D: "Dark Money Bought That Sign" ── */
  .mini-sign-d {
    width: 100%; height: 100%;
    background: #000;
    display: flex; flex-direction: column;
    justify-content: center; align-items: center;
    padding: 8%; text-align: center;
    position: relative; overflow: hidden;
  }
  .mini-sign-d .s-bg {
    position: absolute;
    font-family: 'Bebas Neue', sans-serif;
    font-size: clamp(80px, 16vw, 150px); color: rgba(255,255,255,0.03);
    top: 50%; left: 50%; transform: translate(-50%, -50%);
    white-space: nowrap;
  }
  .mini-sign-d .s-tag {
    display: inline-block;
    border: 1.5px solid #ff3333; padding: 3px 10px;
    margin-bottom: 6%; position: relative; z-index: 1;
    font-family: 'Oswald', sans-serif; font-weight: 700;
    font-size: clamp(8px, 1.2vw, 11px); color: #ff3333;
    text-transform: uppercase; letter-spacing: 2px;
  }
  .mini-sign-d .s-main {
    font-family: 'Bebas Neue', sans-serif;
    font-size: clamp(22px, 4.5vw, 40px); color: #fff;
    line-height: 1; letter-spacing: 1px;
    position: relative; z-index: 1;
  }
  .mini-sign-d .s-highlight {
    font-family: 'Bebas Neue', sans-serif;
    font-size: clamp(22px, 4.5vw, 40px); color: #ff3333;
    line-height: 1; letter-spacing: 1px;
    margin-bottom: 5%; position: relative; z-index: 1;
  }
  .mini-sign-d .s-sub {
    font-family: 'Oswald', sans-serif; font-weight: 600;
    font-size: clamp(10px, 1.5vw, 14px); color: #888;
    text-transform: uppercase; letter-spacing: 2px;
    margin-bottom: 8%; position: relative; z-index: 1;
  }
  .mini-sign-d .s-url {
    font-family: 'Bebas Neue', sans-serif;
    font-size: clamp(12px, 2vw, 18px); color: #ff6b35;
    letter-spacing: 2px; position: relative; z-index: 1;
  }

  /* ── Mini Sign E: "Not Our Water" brand ── */
  .mini-sign-e {
    width: 100%; height: 100%;
    background: linear-gradient(180deg, #0a1628 0%, #0f2440 50%, #0a1628 100%);
    display: flex; flex-direction: column;
    justify-content: center; align-items: center;
    padding: 8%; text-align: center;
    position: relative; overflow: hidden;
  }
  .mini-sign-e .s-accent {
    position: absolute; bottom: 0; left: 0; right: 0;
    height: 25%;
    background: linear-gradient(0deg, rgba(30,90,150,0.15) 0%, transparent 100%);
  }
  .mini-sign-e .s-not {
    font-family: 'Bebas Neue', sans-serif;
    font-size: clamp(14px, 2.5vw, 24px); color: #ff6b35;
    letter-spacing: 6px; position: relative; z-index: 1;
  }
  .mini-sign-e .s-ourwater {
    font-family: 'Bebas Neue', sans-serif;
    font-size: clamp(32px, 7vw, 64px); color: #fff;
    line-height: 0.9; letter-spacing: 3px;
    position: relative; z-index: 1; margin-bottom: 4%;
  }
  .mini-sign-e .s-msg {
    font-family: 'Oswald', sans-serif; font-weight: 600;
    font-size: clamp(9px, 1.3vw, 13px); color: #6699bb;
    text-transform: uppercase; letter-spacing: 3px;
    position: relative; z-index: 1;
  }
  .mini-sign-e .s-msg2 {
    font-family: 'Oswald', sans-serif; font-weight: 600;
    font-size: clamp(8px, 1.1vw, 11px); color: #ff6b35;
    text-transform: uppercase; letter-spacing: 2px;
    margin-bottom: 6%; position: relative; z-index: 1;
  }
  .mini-sign-e .s-cands {
    font-family: 'Oswald', sans-serif; font-weight: 700;
    font-size: clamp(9px, 1.3vw, 12px); color: #fff;
    text-transform: uppercase; letter-spacing: 1px;
    margin-bottom: 5%; position: relative; z-index: 1;
  }
  .mini-sign-e .s-cands .sep { color: #ff6b35; margin: 0 6px; }
  .mini-sign-e .s-url {
    font-family: 'Bebas Neue', sans-serif;
    font-size: clamp(12px, 2vw, 18px); color: #fff;
    letter-spacing: 2px;
    background: rgba(255,107,53,0.2); padding: 3px 14px;
    position: relative; z-index: 1;
  }

  /* ── Mini Sign G: "Tired of These Guys Too?" ── */
  .mini-sign-g {
    width: 100%; height: 100%;
    background: #111;
    display: flex; flex-direction: column;
    justify-content: center; align-items: center;
    padding: 8% 6%; text-align: center;
    position: relative; overflow: hidden;
  }
  .mini-sign-g::before {
    content: ''; position: absolute; top: 0; left: 0; right: 0;
    height: 5px; background: #ff6b35;
  }
  .mini-sign-g::after {
    content: ''; position: absolute; bottom: 0; left: 0; right: 0;
    height: 5px; background: #ff6b35;
  }
  .mini-sign-g .s-tired {
    font-family: 'Bebas Neue', sans-serif;
    font-size: clamp(24px, 5vw, 44px); color: #fff;
    line-height: 1; letter-spacing: 2px;
  }
  .mini-sign-g .s-guys {
    font-family: 'Bebas Neue', sans-serif;
    font-size: clamp(24px, 5vw, 44px); color: #ff6b35;
    line-height: 1; letter-spacing: 2px;
  }
  .mini-sign-g .s-too {
    font-family: 'Bebas Neue', sans-serif;
    font-size: clamp(24px, 5vw, 44px); color: #fff;
    line-height: 1; letter-spacing: 2px;
    margin-bottom: 10%;
  }
  .mini-sign-g .s-vote {
    font-family: 'Oswald', sans-serif; font-weight: 700;
    font-size: clamp(13px, 2.5vw, 22px); color: #fff;
    text-transform: uppercase; letter-spacing: 4px;
  }
  .mini-sign-g .s-date {
    font-family: 'Oswald', sans-serif; font-weight: 600;
    font-size: clamp(10px, 1.5vw, 14px); color: #888;
    text-transform: uppercase; letter-spacing: 3px;
    margin-bottom: 8%;
  }
  .mini-sign-g .s-url {
    font-family: 'Bebas Neue', sans-serif;
    font-size: clamp(12px, 2vw, 20px); color: #ff6b35;
    letter-spacing: 3px;
  }

  /* ── Mini Sign F: "Neighbors, Not Dark Money" ── */
  .mini-sign-f {
    width: 100%; height: 100%;
    background: #f5f0e8;
    display: flex; flex-direction: column;
    justify-content: center; align-items: center;
    padding: 8%; text-align: center;
  }
  .mini-sign-f .s-crossed-row {
    display: flex; align-items: center; gap: 6px;
    margin-bottom: 2%;
  }
  .mini-sign-f .s-crossed {
    font-family: 'Bebas Neue', sans-serif;
    font-size: clamp(18px, 3.5vw, 28px); color: #cc3333;
    letter-spacing: 2px;
    text-decoration: line-through;
    text-decoration-thickness: 4px;
    opacity: 0.6;
  }
  .mini-sign-f .s-crossed-arrow {
    font-family: 'Bebas Neue', sans-serif;
    font-size: clamp(18px, 3.5vw, 28px); color: #cc3333;
    opacity: 0.6;
  }
  .mini-sign-f .s-replacement {
    font-family: 'Bebas Neue', sans-serif;
    font-size: clamp(26px, 5vw, 42px); color: #1b4d7a;
    line-height: 1; letter-spacing: 2px; margin-bottom: 5%;
  }
  .mini-sign-f .s-divider {
    width: 30%; height: 3px;
    background: #ff6b35; margin: 0 auto 5%;
  }
  .mini-sign-f .s-down-arrow {
    font-family: 'Bebas Neue', sans-serif;
    font-size: clamp(22px, 4vw, 36px); color: #1b4d7a;
    line-height: 1; margin: 2% 0;
  }
  .mini-sign-f .s-name {
    font-family: 'Oswald', sans-serif; font-weight: 700;
    font-size: clamp(12px, 2vw, 18px); color: #1b4d7a;
    text-transform: uppercase; line-height: 1.3;
  }
  .mini-sign-f .s-district {
    font-family: 'Inter', sans-serif; font-weight: 700;
    font-size: clamp(7px, 0.9vw, 9px); color: #ff6b35;
    text-transform: uppercase; letter-spacing: 3px;
    margin: 5% 0;
  }
  .mini-sign-f .s-url {
    background: #1b4d7a; padding: 4px 14px;
    font-family: 'Bebas Neue', sans-serif;
    font-size: clamp(11px, 1.8vw, 16px); color: #fff;
    letter-spacing: 2px;
  }

  /* ── Mini Sign H: "TP USA in my SRP?" Dark ── */
  .mini-sign-h {
    width: 100%; height: 100%;
    background: #0d1b2a; border: 5px solid #e63946;
    display: flex; flex-direction: column;
    justify-content: center; align-items: center;
    padding: 8%; text-align: center;
  }
  .mini-sign-h .s-tp {
    font-family: 'Arial Black', Impact, sans-serif;
    font-size: clamp(22px, 4vw, 36px); font-weight: 900;
    color: #e63946; line-height: 1; letter-spacing: 2px;
  }
  .mini-sign-h .s-inmy {
    font-family: Georgia, serif;
    font-size: clamp(11px, 1.6vw, 15px); color: #f0f0f0;
    font-style: italic; margin: 4% 0 1%;
  }
  .mini-sign-h .s-srp {
    font-family: 'Arial Black', Impact, sans-serif;
    font-size: clamp(26px, 4.5vw, 40px); font-weight: 900;
    color: #fff; line-height: 1; letter-spacing: 3px;
    display: inline;
  }
  .mini-sign-h .s-q {
    font-family: 'Arial Black', Impact, sans-serif;
    font-size: clamp(26px, 4.5vw, 40px); font-weight: 900;
    color: #e63946; line-height: 1;
    display: inline;
  }
  .mini-sign-h .s-tag {
    font-size: clamp(8px, 1vw, 10px); color: #ccc;
    text-transform: uppercase; letter-spacing: 1px; margin-top: 6%;
  }
  .mini-sign-h .s-url {
    font-size: clamp(10px, 1.3vw, 12px); color: #e8a838;
    font-weight: 700; letter-spacing: 1px; margin-top: 3%;
  }

  /* ── Mini Sign I: "TP USA in my SRP?" Light ── */
  .mini-sign-i {
    width: 100%; height: 100%;
    background: #f5f0e8; border: 5px solid #1b3a5c;
    display: flex; flex-direction: column;
    justify-content: center; align-items: center;
    padding: 8%; text-align: center;
  }
  .mini-sign-i .s-tp {
    font-family: 'Arial Black', Impact, sans-serif;
    font-size: clamp(22px, 4vw, 36px); font-weight: 900;
    color: #c0392b; line-height: 1; letter-spacing: 2px;
  }
  .mini-sign-i .s-inmy {
    font-family: Georgia, serif;
    font-size: clamp(11px, 1.6vw, 15px); color: #333;
    font-style: italic; margin: 4% 0 1%;
  }
  .mini-sign-i .s-srp {
    font-family: 'Arial Black', Impact, sans-serif;
    font-size: clamp(26px, 4.5vw, 40px); font-weight: 900;
    color: #1b3a5c; line-height: 1; letter-spacing: 3px;
    display: inline;
  }
  .mini-sign-i .s-q {
    font-family: 'Arial Black', Impact, sans-serif;
    font-size: clamp(26px, 4.5vw, 40px); font-weight: 900;
    color: #c0392b; line-height: 1;
    display: inline;
  }
  .mini-sign-i .s-tag {
    font-size: clamp(8px, 1vw, 10px); color: #555;
    text-transform: uppercase; letter-spacing: 1px; margin-top: 6%;
  }
  .mini-sign-i .s-url {
    font-size: clamp(10px, 1.3vw, 12px); color: #1b3a5c;
    font-weight: 700; letter-spacing: 1px; margin-top: 3%;
  }

  .vote-info { padding: 24px; }
  .vote-name {
    font-family: 'Archivo Black', sans-serif;
    font-weight: 400;
    font-size: 18px;
    color: var(--earth-light);
    margin-bottom: 6px;
  }
  .vote-desc {
    font-size: 14px;
    line-height: 1.55;
    color: var(--earth-deep);
    margin-bottom: 20px;
  }

  /* Vote bar */
  .vote-bar-wrap {
    background: var(--bedrock);
    height: 8px;
    width: 100%;
    overflow: hidden;
    margin-bottom: 12px;
  }
  .vote-bar {
    height: 100%;
    width: 0%;
    transition: width 0.6s cubic-bezier(0.16, 1, 0.3, 1);
  }
  .vote-card:nth-child(1) .vote-bar { background: #ff6b35; }
  .vote-card:nth-child(2) .vote-bar { background: #ff3333; }
  .vote-card:nth-child(3) .vote-bar { background: var(--water-bright); }
  .vote-card:nth-child(4) .vote-bar { background: #ff6b35; }
  .vote-card:nth-child(5) .vote-bar { background: #1b4d7a; }
  .vote-card:nth-child(6) .vote-bar { background: #e63946; }
  .vote-card:nth-child(7) .vote-bar { background: #1b3a5c; }

  .vote-stats {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 16px;
  }
  .vote-count {
    font-family: 'Space Mono', monospace;
    font-size: 12px;
    color: var(--earth-deep);
    letter-spacing: 0.5px;
  }
  .vote-count strong {
    color: var(--earth-light);
    font-size: 16px;
  }
  .vote-pct {
    font-family: 'Space Mono', monospace;
    font-size: 20px;
    font-weight: 700;
    color: var(--earth-light);
    letter-spacing: -1px;
  }

  /* Vote button */
  .btn-vote {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    width: 100%;
    font-family: 'Space Mono', monospace;
    font-size: 12px;
    font-weight: 700;
    letter-spacing: 1px;
    text-transform: uppercase;
    padding: 16px;
    border: 2px solid var(--bedrock-light);
    background: transparent;
    color: var(--earth-dark);
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
  }
  .btn-vote:hover {
    border-color: var(--water-bright);
    color: var(--water-bright);
    background: rgba(42, 143, 199, 0.08);
  }
  .btn-vote:active { transform: scale(0.98); }
  .btn-vote.voted {
    border-color: var(--success);
    color: var(--success);
    background: rgba(58, 138, 74, 0.08);
    cursor: default;
  }
  .btn-vote.voted:hover { transform: none; }
  .btn-vote:disabled { opacity: 0.5; cursor: not-allowed; }
  .btn-vote:disabled:hover { transform: none; border-color: var(--bedrock-light); color: var(--earth-dark); background: transparent; }

  /* ══════════════════════════════════
     SUBMIT SECTION
  ══════════════════════════════════ */
  .submit-section {
    background: var(--bedrock);
    padding: clamp(60px, 8vh, 120px) clamp(32px, 6vw, 100px);
    border-top: 1px solid var(--bedrock-light);
  }
  .submit-inner { max-width: 640px; margin: 0 auto; }

  .form-group { margin-bottom: 24px; }
  .form-label {
    display: block;
    font-family: 'Space Mono', monospace;
    font-size: 10px;
    font-weight: 700;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--earth-deep);
    margin-bottom: 8px;
  }
  .form-label .optional {
    font-weight: 400;
    letter-spacing: 0.5px;
    color: rgba(255,255,255,0.25);
    text-transform: none;
    margin-left: 4px;
  }
  .form-input, .form-textarea {
    width: 100%;
    font-family: 'Source Serif 4', Georgia, serif;
    font-size: 16px;
    padding: 14px 16px;
    background: var(--bedrock-mid);
    border: 1px solid var(--bedrock-light);
    color: var(--earth-light);
    outline: none;
    transition: border-color 0.2s ease;
  }
  .form-input:focus, .form-textarea:focus { border-color: var(--water-bright); }
  .form-input::placeholder, .form-textarea::placeholder { color: var(--earth-deep); opacity: 0.5; }
  .form-textarea { resize: vertical; min-height: 100px; line-height: 1.6; }

  .upload-area {
    border: 2px dashed var(--bedrock-light);
    padding: 32px;
    text-align: center;
    cursor: pointer;
    transition: border-color 0.2s ease, background 0.2s ease;
    position: relative;
  }
  .upload-area:hover { border-color: var(--earth-dark); background: rgba(255,255,255,0.02); }
  .upload-area.has-file { border-color: var(--water-bright); border-style: solid; }
  .upload-icon { font-size: 28px; margin-bottom: 8px; opacity: 0.5; }
  .upload-text {
    font-family: 'Space Mono', monospace;
    font-size: 11px;
    font-weight: 700;
    letter-spacing: 0.5px;
    text-transform: uppercase;
    color: var(--earth-deep);
  }
  .upload-hint {
    font-family: 'Space Mono', monospace;
    font-size: 9px;
    color: rgba(255,255,255,0.25);
    margin-top: 8px;
  }
  .upload-area input[type="file"] {
    position: absolute;
    inset: 0;
    opacity: 0;
    cursor: pointer;
  }
  .upload-preview {
    max-width: 200px;
    max-height: 150px;
    margin: 12px auto 0;
    display: none;
  }
  .upload-preview.visible { display: block; }

  .btn-submit {
    background: var(--water);
    color: #fff;
    padding: 18px 40px;
    font-size: 13px;
    width: 100%;
    justify-content: center;
  }
  .btn-submit:hover { box-shadow: 0 8px 32px rgba(26, 107, 154, 0.3); }
  .btn-submit:disabled { opacity: 0.5; cursor: not-allowed; }
  .btn-submit:disabled:hover { transform: none; box-shadow: none; }

  .submit-success {
    display: none;
    text-align: center;
    padding: 48px 32px;
    background: var(--bedrock-mid);
    border: 1px solid var(--bedrock-light);
  }
  .submit-success.visible { display: block; }
  .submit-success-icon { font-size: 48px; margin-bottom: 16px; }
  .submit-success h3 {
    font-family: 'Archivo Black', sans-serif;
    font-weight: 400;
    font-size: 24px;
    color: var(--earth-light);
    margin-bottom: 12px;
  }
  .submit-success p {
    font-size: 15px;
    color: var(--earth-deep);
    line-height: 1.6;
  }

  .hp-field { position: absolute; left: -9999px; opacity: 0; height: 0; }

  /* ══════════════════════════════════
     COMMUNITY GALLERY
  ══════════════════════════════════ */
  .gallery-section {
    background: var(--bedrock);
    padding: clamp(60px, 8vh, 120px) clamp(32px, 6vw, 100px);
    border-top: 1px solid var(--bedrock-light);
  }
  .gallery-inner { max-width: 960px; margin: 0 auto; }
  .gallery-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    gap: 20px;
    margin-top: 32px;
  }
  .gallery-empty {
    grid-column: 1 / -1;
    text-align: center;
    padding: 48px 24px;
    color: var(--earth-deep);
    font-style: italic;
  }
  .gallery-card {
    background: var(--bedrock-mid);
    border: 1px solid var(--bedrock-light);
    overflow: hidden;
    transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1), box-shadow 0.3s cubic-bezier(0.16, 1, 0.3, 1);
  }
  .gallery-card:hover { transform: translateY(-3px); box-shadow: 0 12px 36px rgba(0,0,0,0.25); }
  .gallery-card img {
    width: 100%;
    aspect-ratio: 1;
    object-fit: cover;
    display: block;
    background: var(--bedrock);
  }
  .gallery-card-footer {
    padding: 14px 16px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
  }
  .gallery-card-name {
    font-family: 'Space Mono', monospace;
    font-size: 11px;
    color: var(--earth-deep);
    letter-spacing: 0.3px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    min-width: 0;
  }
  .gallery-votes {
    display: flex;
    gap: 8px;
    flex-shrink: 0;
  }
  .vote-up, .vote-down {
    display: flex;
    align-items: center;
    gap: 4px;
    padding: 5px 10px;
    font-family: 'Space Mono', monospace;
    font-size: 12px;
    font-weight: 700;
    border: 1px solid var(--bedrock-light);
    background: transparent;
    color: var(--earth-deep);
    cursor: pointer;
    transition: all 0.2s ease;
    line-height: 1;
  }
  .vote-up:hover { border-color: var(--water-bright); color: var(--water-bright); }
  .vote-down:hover { border-color: var(--fight-light); color: var(--fight-light); }
  .vote-up.active { border-color: var(--water-bright); color: var(--water-bright); background: rgba(42, 143, 199, 0.12); }
  .vote-down.active { border-color: var(--fight-light); color: var(--fight-light); background: rgba(184, 46, 26, 0.12); }

  /* ══════════════════════════════════
     EDITOR SECTION
  ══════════════════════════════════ */
  .editor-section {
    background: var(--bedrock);
    padding: clamp(60px, 8vh, 120px) clamp(32px, 6vw, 100px);
    border-top: 1px solid var(--bedrock-light);
  }
  .editor-inner { max-width: 720px; margin: 0 auto; }

  .template-strip {
    display: flex;
    gap: 10px;
    overflow-x: auto;
    padding: 8px 0 16px;
    margin-top: 24px;
    -webkit-overflow-scrolling: touch;
  }
  .template-strip::-webkit-scrollbar { height: 4px; }
  .template-strip::-webkit-scrollbar-thumb { background: var(--bedrock-light); border-radius: 2px; }

  .template-thumb {
    flex: 0 0 72px;
    height: 72px;
    border: 2px solid var(--bedrock-light);
    background: var(--bedrock-mid);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Space Mono', monospace;
    font-size: 10px;
    font-weight: 700;
    color: var(--earth-deep);
    letter-spacing: 1px;
    transition: border-color 0.2s ease, transform 0.2s ease;
  }
  .template-thumb:hover { border-color: var(--earth-dark); transform: translateY(-2px); }
  .template-thumb.active { border-color: var(--water-bright); box-shadow: 0 0 0 1px var(--water-bright); }

  .editor-toolbar {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    align-items: center;
    padding: 12px 16px;
    background: var(--bedrock-mid);
    border: 1px solid var(--bedrock-light);
    margin-bottom: 16px;
  }
  .toolbar-sep {
    width: 1px;
    height: 24px;
    background: var(--bedrock-light);
    flex-shrink: 0;
  }
  .toolbar-btn {
    font-family: 'Space Mono', monospace;
    font-size: 11px;
    font-weight: 700;
    letter-spacing: 0.5px;
    padding: 7px 12px;
    border: 1px solid var(--bedrock-light);
    background: transparent;
    color: var(--earth-dark);
    cursor: pointer;
    transition: all 0.2s ease;
    white-space: nowrap;
  }
  .toolbar-btn:hover { border-color: var(--earth-dark); color: var(--earth-light); }
  .toolbar-btn.danger:hover { border-color: var(--fight-light); color: var(--fight-light); }
  .toolbar-select {
    font-family: 'Space Mono', monospace;
    font-size: 11px;
    padding: 7px 8px;
    border: 1px solid var(--bedrock-light);
    background: var(--bedrock);
    color: var(--earth-light);
    cursor: pointer;
    max-width: 140px;
  }
  .toolbar-color {
    width: 30px;
    height: 30px;
    padding: 0;
    border: 2px solid var(--bedrock-light);
    background: none;
    cursor: pointer;
    -webkit-appearance: none;
    appearance: none;
  }
  .toolbar-color::-webkit-color-swatch-wrapper { padding: 0; }
  .toolbar-color::-webkit-color-swatch { border: none; }
  .toolbar-label {
    font-family: 'Space Mono', monospace;
    font-size: 9px;
    color: var(--earth-deep);
    letter-spacing: 1px;
    text-transform: uppercase;
  }

  .canvas-wrapper {
    max-width: 600px;
    margin: 0 auto 32px;
    position: relative;
  }
  .canvas-wrapper canvas { width: 100% !important; height: auto !important; }

  .editor-form { margin-top: 24px; }

  @media (max-width: 700px) {
    .editor-toolbar { gap: 6px; padding: 10px 12px; }
    .toolbar-btn { font-size: 10px; padding: 6px 8px; }
    .toolbar-select { font-size: 10px; max-width: 110px; }
    .template-thumb { flex: 0 0 60px; height: 60px; font-size: 9px; }
    .gallery-grid { grid-template-columns: 1fr; }
  }

  /* ── Footer ── */
  .footer {
    background: var(--bedrock);
    padding: 40px clamp(32px, 6vw, 100px);
    border-top: 1px solid var(--bedrock-light);
  }
  .footer-inner {
    max-width: 1100px;
    margin: 0 auto;
    display: flex;
    justify-content: space-between;
    align-items: start;
    gap: 32px;
    flex-wrap: wrap;
  }
  .footer-brand {
    font-family: 'Archivo Black', sans-serif;
    font-weight: 400;
    font-size: 18px;
    color: var(--earth-deep);
    letter-spacing: 1px;
  }
  .footer p {
    font-family: 'Space Mono', monospace;
    font-size: 10px;
    color: var(--bedrock-light);
    line-height: 1.8;
    letter-spacing: 0.3px;
  }
  .footer a { color: var(--water-bright); text-decoration: none; transition: color 0.2s; }
  .footer a:hover { color: var(--water-surface); }
  .contribution-note {
    font-family: 'Space Mono', monospace;
    font-size: 10px;
    color: rgba(255,255,255,0.3);
    line-height: 1.8;
    letter-spacing: 0.3px;
    max-width: 600px;
    margin: 24px auto 0;
    text-align: center;
    padding: 0 32px;
  }

  .scroll-progress {
    position: fixed;
    top: 0;
    left: 0;
    height: 3px;
    background: var(--water-bright);
    width: 0%;
    z-index: 200;
    transition: width 0.1s linear;
    box-shadow: 0 0 8px rgba(42, 143, 199, 0.5);
  }

  @media (max-width: 700px) {
    .vote-grid { grid-template-columns: 1fr; gap: 20px; }
    .hero h1 { font-size: 40px; letter-spacing: -1px; }
    .section-title { font-size: 32px; }
    .footer-inner { flex-direction: column; }
    .back { top: 12px; left: 12px; font-size: 9px; padding: 8px 12px; }
  }

  @media (prefers-reduced-motion: reduce) {
    *, *::before, *::after { animation-duration: 0.01ms !important; transition-duration: 0.01ms !important; }
    .rv { opacity: 1; transform: none; }
    .hero h1, .hero-sub, .hero-cta { opacity: 1; transform: none; }
    .scroll-progress { display: none; }
  }
</style>
</head>
<body>

<div class="scroll-progress" id="scroll-progress" aria-hidden="true"></div>
<a href="/signs/" class="back"><span style="display:inline-block;margin-right:6px;">&larr;</span> Signs</a>

<!-- ══ HERO ══ -->
<section class="hero">
  <div class="hero-glow" aria-hidden="true"></div>
  <div class="hero-content">
    <h1>VOTE ON <span class="accent">DESIGNS.</span></h1>
    <p class="hero-sub">
      <strong>Help us pick the signs that will answer Turning Point.</strong>
      Vote for your favorites, or submit your own design idea.
    </p>
    <div class="hero-cta">
      <a href="#vote" class="btn btn--fight">Vote Now</a>
      <a href="#submit" class="btn btn--ghost">Design Your Own</a>
    </div>
  </div>
</section>

<!-- ══ VOTE ══ -->
<section class="vote-section" id="vote">
  <div class="vote-inner">
    <div class="marker marker--red rv">
      <span class="marker-line"></span> Cast Your Vote
    </div>
    <h2 class="section-title rv rv-d1">Which sign <br>hits hardest?</h2>
    <p class="section-sub rv rv-d2">
      Vote for as many designs as you like. Results update in real time.
    </p>
    <div class="total-votes rv rv-d2">
      <strong id="total-count">&mdash;</strong> total votes cast
    </div>

    <div class="vote-grid">

      <!-- OPTION B — Issue First -->
      <div class="vote-card rv rv-d2" data-design="design-b">
        <div class="vote-preview">
          <div class="mini-sign-b">
            <div class="s-line1">YOUR WATER.</div>
            <div class="s-line2">THEIR DATA CENTERS.</div>
            <div class="s-divider"></div>
            <div class="s-stat">58 data centers. 905 million gallons a year.<br>Your rates pay for it.</div>
            <div class="s-url">NOTOURWATER.ORG</div>
          </div>
        </div>
        <div class="vote-info">
          <div class="vote-name">"Your Water. Their Data Centers."</div>
          <div class="vote-desc">Issue-first. Works at any intersection, doesn't need another sign next to it. Strong standalone.</div>
          <div class="vote-bar-wrap"><div class="vote-bar" data-bar="design-b"></div></div>
          <div class="vote-stats">
            <span class="vote-count"><strong data-count="design-b">0</strong> votes</span>
            <span class="vote-pct" data-pct="design-b">0%</span>
          </div>
          <button class="btn-vote" data-vote="design-b">Vote for This Design</button>
        </div>
      </div>

      <!-- OPTION D — The Attack -->
      <div class="vote-card rv rv-d3" data-design="design-d">
        <div class="vote-preview">
          <div class="mini-sign-d">
            <div class="s-bg">$$$</div>
            <div class="s-tag">Turning Point USA</div>
            <div class="s-main">DARK MONEY</div>
            <div class="s-highlight">BOUGHT THAT SIGN &rarr;</div>
            <div class="s-sub">Don't let it buy SRP's election.</div>
            <div class="s-url">NOTOURWATER.ORG</div>
          </div>
        </div>
        <div class="vote-info">
          <div class="vote-name">"Dark Money Bought That Sign"</div>
          <div class="vote-desc">Maximum impact. Directly discredits the Turning Point sign next to it. Impossible to ignore.</div>
          <div class="vote-bar-wrap"><div class="vote-bar" data-bar="design-d"></div></div>
          <div class="vote-stats">
            <span class="vote-count"><strong data-count="design-d">0</strong> votes</span>
            <span class="vote-pct" data-pct="design-d">0%</span>
          </div>
          <button class="btn-vote" data-vote="design-d">Vote for This Design</button>
        </div>
      </div>

      <!-- OPTION E — Brand Sign -->
      <div class="vote-card rv rv-d3" data-design="design-e">
        <div class="vote-preview">
          <div class="mini-sign-e">
            <div class="s-accent"></div>
            <div class="s-not">NOT</div>
            <div class="s-ourwater">OUR<br>WATER</div>
            <div class="s-msg">Stop subsidizing data centers</div>
            <div class="s-msg2">Vote District 6 — April 7</div>
            <div class="s-cands">Travise <span class="sep">&middot;</span> Travise</div>
            <div class="s-url">NOTOURWATER.ORG</div>
          </div>
        </div>
        <div class="vote-info">
          <div class="vote-name">"Not Our Water" — The Brand Sign</div>
          <div class="vote-desc">Everything in one sign: brand, issue, candidates, date, and URL. The workhorse. Works anywhere.</div>
          <div class="vote-bar-wrap"><div class="vote-bar" data-bar="design-e"></div></div>
          <div class="vote-stats">
            <span class="vote-count"><strong data-count="design-e">0</strong> votes</span>
            <span class="vote-pct" data-pct="design-e">0%</span>
          </div>
          <button class="btn-vote" data-vote="design-e">Vote for This Design</button>
        </div>
      </div>

      <!-- OPTION F — The Contrast -->
      <div class="vote-card rv rv-d4" data-design="design-f">
        <div class="vote-preview">
          <div class="mini-sign-f">
            <div class="s-crossed-row"><span class="s-crossed">DARK MONEY</span> <span class="s-crossed-arrow">&rarr;</span></div>
            <div class="s-replacement">NEIGHBORS.</div>
            <div class="s-down-arrow">&darr;</div>
            <div class="s-name">John Travise</div>
            <div class="s-name">Sara Travise</div>
            <div class="s-district">SRP District 6 &middot; April 7</div>
            <div class="s-url">NOTOURWATER.ORG</div>
          </div>
        </div>
        <div class="vote-info">
          <div class="vote-name">"Neighbors, Not Dark Money"</div>
          <div class="vote-desc">Light background pops next to dark TPUSA signs. Simple visual metaphor — crossed out and replaced. Names front and center.</div>
          <div class="vote-bar-wrap"><div class="vote-bar" data-bar="design-f"></div></div>
          <div class="vote-stats">
            <span class="vote-count"><strong data-count="design-f">0</strong> votes</span>
            <span class="vote-pct" data-pct="design-f">0%</span>
          </div>
          <button class="btn-vote" data-vote="design-f">Vote for This Design</button>
        </div>
      </div>

      <!-- OPTION G — The Eye Roll -->
      <div class="vote-card rv rv-d4" data-design="design-g">
        <div class="vote-preview">
          <div class="mini-sign-g">
            <div class="s-tired">TIRED OF</div>
            <div class="s-guys">THESE GUYS</div>
            <div class="s-too">TOO? <span style="color:#ff6b35">&rarr;</span></div>
            <div class="s-vote">VOTE DIFFERENT.</div>
            <div class="s-date">APRIL 7</div>
            <div class="s-url">NOTOURWATER.ORG</div>
          </div>
        </div>
        <div class="vote-info">
          <div class="vote-name">"Tired of These Guys Too?"</div>
          <div class="vote-desc">Three lines at 40 mph. Conversational, human, inviting. Everyone's seen the TPUSA signs — this validates the eye-roll.</div>
          <div class="vote-bar-wrap"><div class="vote-bar" data-bar="design-g"></div></div>
          <div class="vote-stats">
            <span class="vote-count"><strong data-count="design-g">0</strong> votes</span>
            <span class="vote-pct" data-pct="design-g">0%</span>
          </div>
          <button class="btn-vote" data-vote="design-g">Vote for This Design</button>
        </div>
      </div>

      <!-- OPTION H — TP USA Dark -->
      <div class="vote-card rv rv-d4" data-design="design-h">
        <div class="vote-preview">
          <div class="mini-sign-h">
            <div class="s-tp">TP USA</div>
            <div class="s-inmy">in my</div>
            <div><span class="s-srp">SRP</span><span class="s-q">?</span></div>
            <div class="s-tag">Not on our watch.</div>
            <div class="s-url">NOTOURWATER.ORG</div>
          </div>
        </div>
        <div class="vote-info">
          <div class="vote-name">"TP USA in my SRP?" — Dark</div>
          <div class="vote-desc">Alarm-red on dark blue. Calls out Turning Point by name. Bold, confrontational, impossible to miss at any intersection.</div>
          <div class="vote-bar-wrap"><div class="vote-bar" data-bar="design-h"></div></div>
          <div class="vote-stats">
            <span class="vote-count"><strong data-count="design-h">0</strong> votes</span>
            <span class="vote-pct" data-pct="design-h">0%</span>
          </div>
          <button class="btn-vote" data-vote="design-h">Vote for This Design</button>
        </div>
      </div>

      <!-- OPTION I — TP USA Light -->
      <div class="vote-card rv rv-d4" data-design="design-i">
        <div class="vote-preview">
          <div class="mini-sign-i">
            <div class="s-tp">TP USA</div>
            <div class="s-inmy">in my</div>
            <div><span class="s-srp">SRP</span><span class="s-q">?</span></div>
            <div class="s-tag">Not on our watch.</div>
            <div class="s-url">NOTOURWATER.ORG</div>
          </div>
        </div>
        <div class="vote-info">
          <div class="vote-name">"TP USA in my SRP?" — Light</div>
          <div class="vote-desc">Light background stands out next to dark TPUSA signs. Outraged-neighbor energy — simple, readable, and it pops.</div>
          <div class="vote-bar-wrap"><div class="vote-bar" data-bar="design-i"></div></div>
          <div class="vote-stats">
            <span class="vote-count"><strong data-count="design-i">0</strong> votes</span>
            <span class="vote-pct" data-pct="design-i">0%</span>
          </div>
          <button class="btn-vote" data-vote="design-i">Vote for This Design</button>
        </div>
      </div>

    </div>
  </div>
</section>

<!-- ══ COMMUNITY GALLERY ══ -->
<section class="gallery-section" id="gallery">
  <div class="gallery-inner">
    <div class="marker marker--blue rv">
      <span class="marker-line"></span> Community Designs
    </div>
    <h2 class="section-title rv rv-d1">Your neighbors'<br>sign ideas.</h2>
    <p class="section-sub rv rv-d2">Vote up the designs you'd put in your yard. Vote down the ones that miss the mark.</p>
    <div class="gallery-grid rv rv-d3" id="gallery-grid">
      <div class="gallery-empty">No submissions yet. Be the first to design one below.</div>
    </div>
  </div>
</section>

<!-- ══ DESIGN YOUR OWN ══ -->
<section class="editor-section" id="submit">
  <div class="editor-inner">
    <div class="marker marker--red rv">
      <span class="marker-line"></span> Design Your Own
    </div>
    <h2 class="section-title rv rv-d1">Got a sign idea?<br>Build it.</h2>
    <p class="section-sub rv rv-d2">Pick a template or start blank. Change text, colors, fonts, add images. Submit your design and let the community vote on it.</p>

    <div class="template-strip rv rv-d3" id="template-strip"></div>

    <div class="editor-toolbar rv rv-d3" id="editor-toolbar">
      <button class="toolbar-btn" id="tb-add-text">+ Text</button>
      <button class="toolbar-btn" id="tb-add-image">+ Image</button>
      <div class="toolbar-sep"></div>
      <select class="toolbar-select" id="tb-font" title="Font">
        <option value="Bebas Neue">Bebas Neue</option>
        <option value="Oswald">Oswald</option>
        <option value="Archivo Black">Archivo Black</option>
        <option value="Impact">Impact</option>
        <option value="Arial Black">Arial Black</option>
        <option value="Space Mono">Space Mono</option>
        <option value="Georgia">Georgia</option>
      </select>
      <select class="toolbar-select" id="tb-size" title="Size">
        <option value="18">18</option>
        <option value="24">24</option>
        <option value="32">32</option>
        <option value="48" selected>48</option>
        <option value="64">64</option>
        <option value="72">72</option>
        <option value="96">96</option>
      </select>
      <div class="toolbar-sep"></div>
      <span class="toolbar-label">Text</span>
      <input type="color" class="toolbar-color" id="tb-text-color" value="#ffffff" title="Text color">
      <span class="toolbar-label">BG</span>
      <input type="color" class="toolbar-color" id="tb-bg-color" value="#1a1612" title="Background color">
      <div class="toolbar-sep"></div>
      <button class="toolbar-btn" id="tb-undo" title="Undo (Ctrl+Z)">Undo</button>
      <button class="toolbar-btn" id="tb-redo" title="Redo (Ctrl+Shift+Z)">Redo</button>
      <button class="toolbar-btn danger" id="tb-delete" title="Delete selected">Del</button>
      <button class="toolbar-btn" id="tb-download" title="Download PNG">Download</button>
    </div>

    <div class="canvas-wrapper rv rv-d3">
      <canvas id="sign-canvas" width="600" height="600"></canvas>
    </div>

    <input type="file" id="editor-file-input" accept="image/*" style="display:none">

    <form id="submit-form" class="editor-form rv rv-d4">
      <div class="form-group">
        <label class="form-label" for="s-name">Name <span class="optional">(optional)</span></label>
        <input type="text" id="s-name" class="form-input" placeholder="Your name">
      </div>
      <div class="form-group">
        <label class="form-label" for="s-email">Email <span class="optional">(optional)</span></label>
        <input type="email" id="s-email" class="form-input" placeholder="you@example.com">
      </div>
      <!-- Honeypot -->
      <div class="hp-field">
        <label for="s-website">Website</label>
        <input type="text" id="s-website" name="website" tabindex="-1" autocomplete="off">
      </div>
      <button type="submit" class="btn btn-submit" id="submit-btn">Submit Your Design</button>
    </form>

    <div class="submit-success" id="submit-success">
      <div class="submit-success-icon">&#9989;</div>
      <h3>Design submitted!</h3>
      <p>Your design is now in the community gallery. Let's see if your neighbors love it too.</p>
    </div>
  </div>
</section>

<!-- ══ FOOTER ══ -->
<footer class="footer">
  <div class="footer-inner">
    <div class="footer-brand">NOTOURWATER.ORG</div>
    <p>
      Paid for by the Energy Freedom Team<br>
      John Travise & Sara Travise<br>
      SRP District 6
    </p>
    <p>
      <a href="/">Home</a> ·
      <a href="/signs/">Fund the Fight</a> ·
      <a href="/signs/sponsor/">Sponsor a Sign</a> ·
      <a href="/signs/map/">Sign Map</a> ·
      <a href="https://energyfreedom.team">Contact</a>
    </p>
  </div>
  <p class="contribution-note">
    Sign sponsorships are considered contributions split evenly between
    Sara Travise and John Travise. Contributions are not tax-deductible.
  </p>
</footer>

<!-- Fabric.js -->
<script src="https://unpkg.com/fabric@6/dist/index.min.js" defer></script>

<!-- PostHog -->
<script>
  !function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.async=!0,p.src=s.api_host+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="init capture register register_once register_for_session unregister opt_out_capturing has_opted_out_capturing opt_in_capturing reset isFeatureEnabled onFeatureFlags getFeatureFlag getFeatureFlagPayload reloadFeatureFlags group updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures getActiveMatchingSurveys getSurveys onSessionId setPersonProperties".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);
  posthog.init('phc_B6KxW3gqUjgK4OmAf1wjUUyijREMbQo597M6jRqByRb', {api_host: 'https://us.i.posthog.com', person_profiles: 'identified_only'});
</script>
<script>
(function() {
  // ── Config ──
  var SUPABASE_URL = 'https://api.energyfreedom.team';
  var SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlzcyI6InN1cGFiYXNlIiwiaWF0IjoxNzA0MDY3MjAwLCJleHAiOjE4OTM0NTYwMDB9.ijz5qNCy2uf8u9K0Bg8piaaI0MeH6CKBJTmN22dFoZU';
  var DESIGNS = ['design-b', 'design-d', 'design-e', 'design-f', 'design-g', 'design-h', 'design-i'];

  // ── Supabase REST helper ──
  function supaFetch(path, opts) {
    opts = opts || {};
    var headers = {
      'apikey': SUPABASE_KEY,
      'Authorization': 'Bearer ' + SUPABASE_KEY,
      'Content-Type': 'application/json'
    };
    if (opts.prefer) headers['Prefer'] = opts.prefer;
    if (opts.headers) {
      Object.keys(opts.headers).forEach(function(k) { headers[k] = opts.headers[k]; });
    }
    return fetch(SUPABASE_URL + '/rest/v1/' + path, {
      method: opts.method || 'GET',
      headers: headers,
      body: opts.body ? JSON.stringify(opts.body) : undefined
    }).then(function(r) {
      if (opts.method === 'POST' && r.status === 409) return { conflict: true };
      if (r.status === 201 || r.status === 204) return { ok: true };
      return r.json();
    });
  }

  // ── Voter fingerprint ──
  var cachedHash = null;
  function getVoterHash() {
    if (cachedHash) return Promise.resolve(cachedHash);
    var raw = navigator.userAgent + screen.width + 'x' + screen.height + Intl.DateTimeFormat().resolvedOptions().timeZone;
    return crypto.subtle.digest('SHA-256', new TextEncoder().encode(raw)).then(function(buf) {
      cachedHash = Array.from(new Uint8Array(buf)).map(function(b) { return b.toString(16).padStart(2, '0'); }).join('');
      return cachedHash;
    });
  }

  // ── Local vote state (for design poll votes) ──
  function getLocalVotes() {
    try { return JSON.parse(localStorage.getItem('sign_poll_votes') || '{}'); } catch(e) { return {}; }
  }
  function setLocalVote(designId) {
    var votes = getLocalVotes();
    votes[designId] = true;
    localStorage.setItem('sign_poll_votes', JSON.stringify(votes));
  }

  // ── Fetch & render design vote counts ──
  function fetchCounts() {
    return supaFetch('sign_poll_vote_counts?select=design_id,vote_count').then(function(rows) {
      if (!Array.isArray(rows)) return {};
      var counts = {};
      DESIGNS.forEach(function(d) { counts[d] = 0; });
      rows.forEach(function(r) {
        if (counts[r.design_id] !== undefined) counts[r.design_id] = r.vote_count;
      });
      return counts;
    });
  }

  function renderCounts(counts) {
    var total = 0;
    DESIGNS.forEach(function(d) { total += (counts[d] || 0); });
    var totalEl = document.getElementById('total-count');
    if (totalEl) totalEl.textContent = total;
    DESIGNS.forEach(function(d) {
      var c = counts[d] || 0;
      var pct = total > 0 ? Math.round((c / total) * 100) : 0;
      var barEl = document.querySelector('[data-bar="' + d + '"]');
      var countEl = document.querySelector('[data-count="' + d + '"]');
      var pctEl = document.querySelector('[data-pct="' + d + '"]');
      if (barEl) barEl.style.width = pct + '%';
      if (countEl) countEl.textContent = c;
      if (pctEl) pctEl.textContent = pct + '%';
    });
  }

  function markVotedButtons() {
    var local = getLocalVotes();
    DESIGNS.forEach(function(d) {
      if (local[d]) {
        var btn = document.querySelector('[data-vote="' + d + '"]');
        if (btn) { btn.classList.add('voted'); btn.textContent = '\u2713 Voted'; }
      }
    });
  }

  function setupVoteButtons() {
    document.querySelectorAll('.btn-vote').forEach(function(btn) {
      btn.addEventListener('click', function() {
        var designId = btn.getAttribute('data-vote');
        if (btn.classList.contains('voted') || btn.disabled) return;
        btn.disabled = true;
        btn.textContent = 'Voting...';
        getVoterHash().then(function(hash) {
          return supaFetch('sign_poll_votes', {
            method: 'POST',
            body: { design_id: designId, voter_hash: hash },
            prefer: 'return=minimal'
          });
        }).then(function(result) {
          btn.classList.add('voted');
          btn.textContent = (result && result.conflict) ? '\u2713 Already Voted' : '\u2713 Voted';
          if (!(result && result.conflict) && typeof posthog !== 'undefined') {
            posthog.capture('sign_poll_vote', { design: designId });
          }
          setLocalVote(designId);
          btn.disabled = false;
          return fetchCounts();
        }).then(renderCounts).catch(function() {
          btn.textContent = 'Error \u2014 try again';
          btn.disabled = false;
        });
      });
    });
  }

  // ══════════════════════════════════
  // COMMUNITY GALLERY
  // ══════════════════════════════════

  var galleryGrid = document.getElementById('gallery-grid');
  var mySubmissionVotes = {}; // { submissionId: 'up'|'down' }

  function fetchSubmissions() {
    return supaFetch('sign_poll_submissions?approved=eq.true&select=id,name,image_url,created_at&order=created_at.desc')
      .then(function(rows) { return Array.isArray(rows) ? rows : []; });
  }

  function fetchSubmissionVoteCounts() {
    return supaFetch('sign_submission_vote_counts?select=submission_id,upvotes,downvotes')
      .then(function(rows) {
        if (!Array.isArray(rows)) return {};
        var map = {};
        rows.forEach(function(r) { map[r.submission_id] = { up: Number(r.upvotes) || 0, down: Number(r.downvotes) || 0 }; });
        return map;
      });
  }

  function fetchMySubmissionVotes(hash) {
    return supaFetch('sign_submission_votes?voter_hash=eq.' + hash + '&select=submission_id,vote_type')
      .then(function(rows) {
        if (!Array.isArray(rows)) return {};
        var map = {};
        rows.forEach(function(r) { map[r.submission_id] = r.vote_type; });
        return map;
      });
  }

  function renderGallery(submissions, voteCounts, myVotes) {
    mySubmissionVotes = myVotes || {};
    if (!galleryGrid) return;
    if (!submissions.length) {
      galleryGrid.innerHTML = '<div class="gallery-empty">No submissions yet. Be the first to design one below.</div>';
      return;
    }
    galleryGrid.innerHTML = submissions.map(function(s) {
      var vc = voteCounts[s.id] || { up: 0, down: 0 };
      var myVote = mySubmissionVotes[s.id] || '';
      var displayName = s.name ? s.name.split(' ')[0] : 'Anonymous';
      return '<div class="gallery-card" data-sid="' + s.id + '">' +
        '<img src="' + s.image_url + '" alt="Community sign design by ' + displayName + '" loading="lazy">' +
        '<div class="gallery-card-footer">' +
          '<span class="gallery-card-name">By ' + displayName + '</span>' +
          '<div class="gallery-votes">' +
            '<button class="vote-up' + (myVote === 'up' ? ' active' : '') + '" data-sid="' + s.id + '" data-dir="up">\u25B2 <span>' + vc.up + '</span></button>' +
            '<button class="vote-down' + (myVote === 'down' ? ' active' : '') + '" data-sid="' + s.id + '" data-dir="down">\u25BC <span>' + vc.down + '</span></button>' +
          '</div>' +
        '</div>' +
      '</div>';
    }).join('');
  }

  function loadGallery() {
    return Promise.all([fetchSubmissions(), fetchSubmissionVoteCounts(), getVoterHash().then(fetchMySubmissionVotes)])
      .then(function(results) { renderGallery(results[0], results[1], results[2]); });
  }

  // Gallery vote handler (delegated)
  if (galleryGrid) {
    galleryGrid.addEventListener('click', function(e) {
      var btn = e.target.closest('.vote-up, .vote-down');
      if (!btn) return;
      var sid = btn.getAttribute('data-sid');
      var dir = btn.getAttribute('data-dir');
      var currentVote = mySubmissionVotes[sid] || '';

      btn.style.opacity = '0.5';

      getVoterHash().then(function(hash) {
        // Always delete existing vote first
        return supaFetch('sign_submission_votes?submission_id=eq.' + sid + '&voter_hash=eq.' + hash, {
          method: 'DELETE',
          prefer: 'return=minimal'
        }).then(function() {
          if (currentVote === dir) {
            // Toggle off — just delete
            delete mySubmissionVotes[sid];
          } else {
            // Insert new vote
            return supaFetch('sign_submission_votes', {
              method: 'POST',
              body: { submission_id: sid, voter_hash: hash, vote_type: dir },
              prefer: 'return=minimal'
            }).then(function() { mySubmissionVotes[sid] = dir; });
          }
        });
      }).then(function() {
        // Refresh just the counts
        return fetchSubmissionVoteCounts();
      }).then(function(voteCounts) {
        // Update this card's buttons
        var card = galleryGrid.querySelector('[data-sid="' + sid + '"].gallery-card');
        if (!card) return;
        var vc = voteCounts[sid] || { up: 0, down: 0 };
        var myVote = mySubmissionVotes[sid] || '';
        var upBtn = card.querySelector('.vote-up');
        var downBtn = card.querySelector('.vote-down');
        if (upBtn) {
          upBtn.className = 'vote-up' + (myVote === 'up' ? ' active' : '');
          upBtn.querySelector('span').textContent = vc.up;
          upBtn.style.opacity = '';
        }
        if (downBtn) {
          downBtn.className = 'vote-down' + (myVote === 'down' ? ' active' : '');
          downBtn.querySelector('span').textContent = vc.down;
          downBtn.style.opacity = '';
        }
      }).catch(function() { btn.style.opacity = ''; });
    });
  }

  // ══════════════════════════════════
  // FABRIC.JS EDITOR
  // ══════════════════════════════════

  var fabricCanvas = null;
  var undoStack = [];
  var redoStack = [];
  var isUndoRedo = false;
  var textChangeTimer = null;

  // ── Template definitions ──
  var TEMPLATES = {
    'Blank': {
      backgroundColor: '#1a1612',
      objects: [
        { type: 'Textbox', text: 'YOUR TEXT HERE', left: 120, top: 240, width: 360, fontFamily: 'Bebas Neue', fontSize: 60, fill: '#ffffff', textAlign: 'center' }
      ]
    },
    'B': {
      backgroundColor: '#1a0a00',
      objects: [
        { type: 'Rect', left: 0, top: 0, width: 600, height: 6, fill: '#ff6b35', selectable: false, evented: false },
        { type: 'Rect', left: 0, top: 594, width: 600, height: 6, fill: '#ff6b35', selectable: false, evented: false },
        { type: 'Textbox', text: 'YOUR WATER.', left: 48, top: 160, width: 504, fontFamily: 'Bebas Neue', fontSize: 72, fill: '#ffffff', textAlign: 'center' },
        { type: 'Textbox', text: 'THEIR DATA CENTERS.', left: 48, top: 240, width: 504, fontFamily: 'Bebas Neue', fontSize: 52, fill: '#ff6b35', textAlign: 'center' },
        { type: 'Rect', left: 225, top: 310, width: 150, height: 2, fill: 'rgba(255,107,53,0.4)', selectable: false, evented: false },
        { type: 'Textbox', text: '58 data centers. 905 million gallons a year.\nYour rates pay for it.', left: 100, top: 330, width: 400, fontFamily: 'Oswald', fontSize: 18, fill: '#cc8855', textAlign: 'center' },
        { type: 'Textbox', text: 'NOTOURWATER.ORG', left: 170, top: 440, width: 260, fontFamily: 'Bebas Neue', fontSize: 36, fill: '#ffffff', textAlign: 'center' }
      ]
    },
    'D': {
      backgroundColor: '#000000',
      objects: [
        { type: 'Textbox', text: 'TURNING POINT USA', left: 150, top: 100, width: 300, fontFamily: 'Oswald', fontSize: 16, fill: '#ff3333', textAlign: 'center' },
        { type: 'Textbox', text: 'DARK MONEY', left: 48, top: 180, width: 504, fontFamily: 'Bebas Neue', fontSize: 68, fill: '#ffffff', textAlign: 'center' },
        { type: 'Textbox', text: 'BOUGHT THAT SIGN \u2192', left: 48, top: 255, width: 504, fontFamily: 'Bebas Neue', fontSize: 68, fill: '#ff3333', textAlign: 'center' },
        { type: 'Textbox', text: "Don't let it buy SRP's election.", left: 130, top: 340, width: 340, fontFamily: 'Oswald', fontSize: 20, fill: '#888888', textAlign: 'center' },
        { type: 'Textbox', text: 'NOTOURWATER.ORG', left: 180, top: 440, width: 240, fontFamily: 'Bebas Neue', fontSize: 30, fill: '#ff6b35', textAlign: 'center' }
      ]
    },
    'E': {
      backgroundColor: '#0a1628',
      objects: [
        { type: 'Textbox', text: 'NOT', left: 200, top: 120, width: 200, fontFamily: 'Bebas Neue', fontSize: 36, fill: '#ff6b35', textAlign: 'center', letterSpacing: 300 },
        { type: 'Textbox', text: 'OUR\nWATER', left: 100, top: 165, width: 400, fontFamily: 'Bebas Neue', fontSize: 100, fill: '#ffffff', textAlign: 'center', lineHeight: 0.9 },
        { type: 'Textbox', text: 'STOP SUBSIDIZING DATA CENTERS', left: 100, top: 360, width: 400, fontFamily: 'Oswald', fontSize: 18, fill: '#6699bb', textAlign: 'center' },
        { type: 'Textbox', text: 'VOTE DISTRICT 6 \u2014 APRIL 7', left: 130, top: 390, width: 340, fontFamily: 'Oswald', fontSize: 15, fill: '#ff6b35', textAlign: 'center' },
        { type: 'Textbox', text: 'TRAVISE \u00B7 TRAVISE', left: 150, top: 425, width: 300, fontFamily: 'Oswald', fontSize: 18, fill: '#ffffff', textAlign: 'center' },
        { type: 'Textbox', text: 'NOTOURWATER.ORG', left: 175, top: 475, width: 250, fontFamily: 'Bebas Neue', fontSize: 28, fill: '#ffffff', textAlign: 'center' }
      ]
    },
    'F': {
      backgroundColor: '#f5f0e8',
      objects: [
        { type: 'Textbox', text: 'DARK MONEY', left: 120, top: 100, width: 280, fontFamily: 'Bebas Neue', fontSize: 44, fill: '#cc3333', textAlign: 'center', linethrough: true },
        { type: 'Textbox', text: 'NEIGHBORS.', left: 80, top: 170, width: 440, fontFamily: 'Bebas Neue', fontSize: 72, fill: '#1b4d7a', textAlign: 'center' },
        { type: 'Rect', left: 210, top: 260, width: 180, height: 3, fill: '#ff6b35', selectable: false, evented: false },
        { type: 'Textbox', text: '\u2193', left: 270, top: 270, width: 60, fontFamily: 'Bebas Neue', fontSize: 50, fill: '#1b4d7a', textAlign: 'center' },
        { type: 'Textbox', text: 'JOHN TRAVISE\nSARA TRAVISE', left: 150, top: 335, width: 300, fontFamily: 'Oswald', fontSize: 28, fill: '#1b4d7a', textAlign: 'center', lineHeight: 1.3 },
        { type: 'Textbox', text: 'SRP DISTRICT 6 \u00B7 APRIL 7', left: 170, top: 425, width: 260, fontFamily: 'Oswald', fontSize: 13, fill: '#ff6b35', textAlign: 'center' },
        { type: 'Textbox', text: 'NOTOURWATER.ORG', left: 195, top: 470, width: 210, fontFamily: 'Bebas Neue', fontSize: 24, fill: '#ffffff', textAlign: 'center', backgroundColor: '#1b4d7a' }
      ]
    },
    'G': {
      backgroundColor: '#111111',
      objects: [
        { type: 'Rect', left: 0, top: 0, width: 600, height: 5, fill: '#ff6b35', selectable: false, evented: false },
        { type: 'Rect', left: 0, top: 595, width: 600, height: 5, fill: '#ff6b35', selectable: false, evented: false },
        { type: 'Textbox', text: 'TIRED OF', left: 80, top: 120, width: 440, fontFamily: 'Bebas Neue', fontSize: 72, fill: '#ffffff', textAlign: 'center' },
        { type: 'Textbox', text: 'THESE GUYS', left: 80, top: 192, width: 440, fontFamily: 'Bebas Neue', fontSize: 72, fill: '#ff6b35', textAlign: 'center' },
        { type: 'Textbox', text: 'TOO? \u2192', left: 80, top: 264, width: 440, fontFamily: 'Bebas Neue', fontSize: 72, fill: '#ffffff', textAlign: 'center' },
        { type: 'Textbox', text: 'VOTE DIFFERENT.', left: 120, top: 380, width: 360, fontFamily: 'Oswald', fontSize: 32, fill: '#ffffff', textAlign: 'center' },
        { type: 'Textbox', text: 'APRIL 7', left: 200, top: 420, width: 200, fontFamily: 'Oswald', fontSize: 20, fill: '#888888', textAlign: 'center' },
        { type: 'Textbox', text: 'NOTOURWATER.ORG', left: 150, top: 490, width: 300, fontFamily: 'Bebas Neue', fontSize: 32, fill: '#ff6b35', textAlign: 'center' }
      ]
    },
    'H': {
      backgroundColor: '#0d1b2a',
      objects: [
        { type: 'Rect', left: 0, top: 0, width: 600, height: 600, fill: 'transparent', stroke: '#e63946', strokeWidth: 10, selectable: false, evented: false },
        { type: 'Textbox', text: 'TP USA', left: 120, top: 140, width: 360, fontFamily: 'Arial Black', fontSize: 60, fill: '#e63946', textAlign: 'center' },
        { type: 'Textbox', text: 'in my', left: 200, top: 220, width: 200, fontFamily: 'Georgia', fontSize: 24, fill: '#f0f0f0', textAlign: 'center', fontStyle: 'italic' },
        { type: 'Textbox', text: 'SRP?', left: 120, top: 260, width: 360, fontFamily: 'Arial Black', fontSize: 70, fill: '#ffffff', textAlign: 'center' },
        { type: 'Textbox', text: 'NOT ON OUR WATCH.', left: 150, top: 380, width: 300, fontFamily: 'Oswald', fontSize: 16, fill: '#cccccc', textAlign: 'center' },
        { type: 'Textbox', text: 'NOTOURWATER.ORG', left: 160, top: 430, width: 280, fontFamily: 'Oswald', fontSize: 18, fill: '#e8a838', textAlign: 'center' }
      ]
    },
    'I': {
      backgroundColor: '#f5f0e8',
      objects: [
        { type: 'Rect', left: 0, top: 0, width: 600, height: 600, fill: 'transparent', stroke: '#1b3a5c', strokeWidth: 10, selectable: false, evented: false },
        { type: 'Textbox', text: 'TP USA', left: 120, top: 140, width: 360, fontFamily: 'Arial Black', fontSize: 60, fill: '#c0392b', textAlign: 'center' },
        { type: 'Textbox', text: 'in my', left: 200, top: 220, width: 200, fontFamily: 'Georgia', fontSize: 24, fill: '#333333', textAlign: 'center', fontStyle: 'italic' },
        { type: 'Textbox', text: 'SRP?', left: 120, top: 260, width: 360, fontFamily: 'Arial Black', fontSize: 70, fill: '#1b3a5c', textAlign: 'center' },
        { type: 'Textbox', text: 'NOT ON OUR WATCH.', left: 150, top: 380, width: 300, fontFamily: 'Oswald', fontSize: 16, fill: '#555555', textAlign: 'center' },
        { type: 'Textbox', text: 'NOTOURWATER.ORG', left: 160, top: 430, width: 280, fontFamily: 'Oswald', fontSize: 18, fill: '#1b3a5c', textAlign: 'center' }
      ]
    }
  };

  function initEditor() {
    if (typeof fabric === 'undefined') {
      setTimeout(initEditor, 100);
      return;
    }

    fabricCanvas = new fabric.Canvas('sign-canvas', {
      width: 600,
      height: 600,
      backgroundColor: '#1a1612',
      preserveObjectStacking: true
    });

    // Build template strip
    var strip = document.getElementById('template-strip');
    if (strip) {
      var names = Object.keys(TEMPLATES);
      names.forEach(function(name, i) {
        var thumb = document.createElement('button');
        thumb.className = 'template-thumb' + (i === 0 ? ' active' : '');
        thumb.textContent = name === 'Blank' ? '+ NEW' : name;
        thumb.setAttribute('data-tmpl', name);
        thumb.addEventListener('click', function() {
          strip.querySelectorAll('.template-thumb').forEach(function(t) { t.classList.remove('active'); });
          thumb.classList.add('active');
          loadTemplate(name);
        });
        strip.appendChild(thumb);
      });
    }

    // Load default template
    loadTemplate('Blank');

    // ── Toolbar handlers ──
    var fontSelect = document.getElementById('tb-font');
    var sizeSelect = document.getElementById('tb-size');
    var textColorInput = document.getElementById('tb-text-color');
    var bgColorInput = document.getElementById('tb-bg-color');
    var fileInput = document.getElementById('editor-file-input');

    document.getElementById('tb-add-text').addEventListener('click', function() {
      var t = new fabric.Textbox('YOUR TEXT', {
        left: 150, top: 250, width: 300,
        fontFamily: fontSelect.value,
        fontSize: parseInt(sizeSelect.value),
        fill: textColorInput.value,
        textAlign: 'center'
      });
      fabricCanvas.add(t);
      fabricCanvas.setActiveObject(t);
      fabricCanvas.requestRenderAll();
    });

    document.getElementById('tb-add-image').addEventListener('click', function() {
      fileInput.click();
    });

    fileInput.addEventListener('change', function() {
      var file = fileInput.files[0];
      if (!file) return;
      var reader = new FileReader();
      reader.onload = function(e) {
        var imgEl = new Image();
        imgEl.onload = function() {
          var fImg = new fabric.FabricImage(imgEl);
          var scale = Math.min(300 / fImg.width, 300 / fImg.height, 1);
          fImg.set({ left: 150, top: 150, scaleX: scale, scaleY: scale });
          fabricCanvas.add(fImg);
          fabricCanvas.setActiveObject(fImg);
          fabricCanvas.requestRenderAll();
        };
        imgEl.src = e.target.result;
      };
      reader.readAsDataURL(file);
      fileInput.value = '';
    });

    fontSelect.addEventListener('change', function() {
      var obj = fabricCanvas.getActiveObject();
      if (obj && obj.type === 'Textbox') {
        obj.set('fontFamily', fontSelect.value);
        fabricCanvas.requestRenderAll();
      }
    });

    sizeSelect.addEventListener('change', function() {
      var obj = fabricCanvas.getActiveObject();
      if (obj && obj.type === 'Textbox') {
        obj.set('fontSize', parseInt(sizeSelect.value));
        fabricCanvas.requestRenderAll();
      }
    });

    textColorInput.addEventListener('input', function() {
      var obj = fabricCanvas.getActiveObject();
      if (obj && obj.type === 'Textbox') {
        obj.set('fill', textColorInput.value);
        fabricCanvas.requestRenderAll();
      }
    });

    bgColorInput.addEventListener('input', function() {
      fabricCanvas.backgroundColor = bgColorInput.value;
      fabricCanvas.requestRenderAll();
    });

    document.getElementById('tb-delete').addEventListener('click', function() {
      var obj = fabricCanvas.getActiveObject();
      if (obj) {
        fabricCanvas.remove(obj);
        fabricCanvas.discardActiveObject();
        fabricCanvas.requestRenderAll();
      }
    });

    document.getElementById('tb-download').addEventListener('click', function() {
      var dataUrl = fabricCanvas.toDataURL({ format: 'png', multiplier: 2 });
      var a = document.createElement('a');
      a.href = dataUrl;
      a.download = 'notourwater-sign-' + Date.now() + '.png';
      a.click();
    });

    // Undo / redo
    document.getElementById('tb-undo').addEventListener('click', doUndo);
    document.getElementById('tb-redo').addEventListener('click', doRedo);

    // Selection sync: update toolbar to match selected object
    fabricCanvas.on('selection:created', syncToolbar);
    fabricCanvas.on('selection:updated', syncToolbar);

    // Undo state tracking
    fabricCanvas.on('object:modified', saveUndoState);
    fabricCanvas.on('object:added', function() { if (!isUndoRedo) saveUndoState(); });
    fabricCanvas.on('object:removed', function() { if (!isUndoRedo) saveUndoState(); });
    fabricCanvas.on('text:changed', function() {
      clearTimeout(textChangeTimer);
      textChangeTimer = setTimeout(saveUndoState, 500);
    });

    // Keyboard shortcuts
    document.addEventListener('keydown', function(e) {
      if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA' || e.target.tagName === 'SELECT') return;
      if ((e.metaKey || e.ctrlKey) && e.key === 'z' && !e.shiftKey) { e.preventDefault(); doUndo(); }
      if ((e.metaKey || e.ctrlKey) && e.key === 'z' && e.shiftKey) { e.preventDefault(); doRedo(); }
      if (e.key === 'Delete' || e.key === 'Backspace') {
        var obj = fabricCanvas.getActiveObject();
        if (obj && !obj.isEditing) { e.preventDefault(); fabricCanvas.remove(obj); fabricCanvas.discardActiveObject(); fabricCanvas.requestRenderAll(); }
      }
    });
  }

  function loadTemplate(name) {
    var tmpl = TEMPLATES[name];
    if (!tmpl || !fabricCanvas) return;

    isUndoRedo = true;
    fabricCanvas.clear();
    fabricCanvas.backgroundColor = tmpl.backgroundColor;

    tmpl.objects.forEach(function(def) {
      var obj;
      if (def.type === 'Rect') {
        obj = new fabric.Rect({
          left: def.left, top: def.top, width: def.width, height: def.height,
          fill: def.fill || 'transparent', stroke: def.stroke || null,
          strokeWidth: def.strokeWidth || 0,
          selectable: def.selectable !== false, evented: def.evented !== false
        });
      } else if (def.type === 'Textbox') {
        obj = new fabric.Textbox(def.text, {
          left: def.left, top: def.top, width: def.width,
          fontFamily: def.fontFamily || 'Bebas Neue',
          fontSize: def.fontSize || 48,
          fill: def.fill || '#ffffff',
          textAlign: def.textAlign || 'left',
          lineHeight: def.lineHeight || 1.1,
          fontStyle: def.fontStyle || 'normal',
          linethrough: def.linethrough || false,
          backgroundColor: def.backgroundColor || ''
        });
      }
      if (obj) fabricCanvas.add(obj);
    });

    fabricCanvas.requestRenderAll();
    isUndoRedo = false;
    undoStack = [JSON.stringify(fabricCanvas.toJSON())];
    redoStack = [];

    // Update BG color picker
    var bgInput = document.getElementById('tb-bg-color');
    if (bgInput) bgInput.value = tmpl.backgroundColor;
  }

  function syncToolbar() {
    var obj = fabricCanvas.getActiveObject();
    if (!obj || obj.type !== 'Textbox') return;
    var fontSelect = document.getElementById('tb-font');
    var sizeSelect = document.getElementById('tb-size');
    var textColorInput = document.getElementById('tb-text-color');
    if (fontSelect) fontSelect.value = obj.fontFamily || 'Bebas Neue';
    if (sizeSelect) {
      var closest = [18,24,32,48,64,72,96].reduce(function(p,c) {
        return Math.abs(c - obj.fontSize) < Math.abs(p - obj.fontSize) ? c : p;
      });
      sizeSelect.value = closest;
    }
    if (textColorInput) textColorInput.value = obj.fill || '#ffffff';
  }

  function saveUndoState() {
    if (isUndoRedo || !fabricCanvas) return;
    var json = JSON.stringify(fabricCanvas.toJSON());
    if (undoStack.length && undoStack[undoStack.length - 1] === json) return;
    undoStack.push(json);
    if (undoStack.length > 50) undoStack.shift();
    redoStack = [];
  }

  function doUndo() {
    if (undoStack.length <= 1 || !fabricCanvas) return;
    isUndoRedo = true;
    redoStack.push(undoStack.pop());
    var state = undoStack[undoStack.length - 1];
    fabricCanvas.loadFromJSON(state).then(function() {
      fabricCanvas.requestRenderAll();
      isUndoRedo = false;
    });
  }

  function doRedo() {
    if (!redoStack.length || !fabricCanvas) return;
    isUndoRedo = true;
    var state = redoStack.pop();
    undoStack.push(state);
    fabricCanvas.loadFromJSON(state).then(function() {
      fabricCanvas.requestRenderAll();
      isUndoRedo = false;
    });
  }

  // ══════════════════════════════════
  // UPLOAD + SUBMIT
  // ══════════════════════════════════

  function uploadPNG(blob) {
    var name = Date.now() + '-' + Math.random().toString(36).slice(2, 8) + '.png';
    return fetch(SUPABASE_URL + '/storage/v1/object/sign-submissions/' + name, {
      method: 'POST',
      headers: {
        'apikey': SUPABASE_KEY,
        'Authorization': 'Bearer ' + SUPABASE_KEY,
        'Content-Type': 'image/png'
      },
      body: blob
    }).then(function(r) {
      if (!r.ok) throw new Error('Upload failed');
      return SUPABASE_URL + '/storage/v1/object/public/sign-submissions/' + name;
    });
  }

  var form = document.getElementById('submit-form');
  var submitBtn = document.getElementById('submit-btn');
  var successEl = document.getElementById('submit-success');

  if (form) {
    form.addEventListener('submit', function(e) {
      e.preventDefault();
      if (document.getElementById('s-website').value) return;
      if (!fabricCanvas) return;

      submitBtn.disabled = true;
      submitBtn.textContent = 'Exporting...';

      // Export canvas as PNG at 2x (1200x1200)
      var dataUrl = fabricCanvas.toDataURL({ format: 'png', multiplier: 2 });

      submitBtn.textContent = 'Uploading...';

      fetch(dataUrl).then(function(r) { return r.blob(); }).then(function(blob) {
        return uploadPNG(blob);
      }).then(function(imageUrl) {
        submitBtn.textContent = 'Saving...';
        return supaFetch('sign_poll_submissions', {
          method: 'POST',
          body: {
            name: document.getElementById('s-name').value.trim() || null,
            email: document.getElementById('s-email').value.trim() || null,
            description: 'Custom design (editor)',
            image_url: imageUrl
          },
          prefer: 'return=minimal'
        });
      }).then(function() {
        form.style.display = 'none';
        successEl.classList.add('visible');
        if (typeof posthog !== 'undefined') posthog.capture('sign_poll_submission_editor');
        // Refresh gallery
        loadGallery();
      }).catch(function() {
        submitBtn.textContent = 'Error \u2014 try again';
        submitBtn.disabled = false;
      });
    });
  }

  // ── Init ──
  fetchCounts().then(renderCounts);
  markVotedButtons();
  setupVoteButtons();
  loadGallery();

  // Init editor after fonts + fabric loaded
  document.fonts.ready.then(function() { initEditor(); });

  // ── Scroll progress ──
  (function() {
    var bar = document.getElementById('scroll-progress');
    if (!bar) return;
    var ticking = false;
    window.addEventListener('scroll', function() {
      if (!ticking) {
        requestAnimationFrame(function() {
          var h = document.documentElement.scrollHeight - window.innerHeight;
          bar.style.width = h > 0 ? ((window.scrollY / h) * 100) + '%' : '0%';
          ticking = false;
        });
        ticking = true;
      }
    }, { passive: true });
  })();

  // ── Scroll reveal ──
  var obs = new IntersectionObserver(function(entries) {
    entries.forEach(function(entry) {
      if (entry.isIntersecting) {
        entry.target.classList.add('vis');
        obs.unobserve(entry.target);
      }
    });
  }, { threshold: 0.12, rootMargin: '0px 0px -30px 0px' });
  document.querySelectorAll('.rv').forEach(function(el) { obs.observe(el); });
})();
</script>
</body>
</html>
